<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Family Income</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            .node circle {
              fill: #fff;
              stroke: steelblue;
              stroke-width: 1.5px;
            }

            .node {
              font: 10px sans-serif;
            }

            .link {
              fill: none;
              stroke: #ccc;
              stroke-width: 1.5px;
            }
            
        </style>
    </head>
    <body>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script>
        
        var width = 900,
        height = 550;    
        margin = 30;

        
        
 
 
        //beginning of tree section
 
        var tree = d3.layout.cluster()
                .size([height, width - 260]);
        
        var diagonal = d3.svg.diagonal()
                .projection(function(d) {return [d.y + margin, d.x];});
        
        var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", "translate(40,0)");
        

        
        d3.json("income.json", function(error, root) {
            var nodes = tree.nodes(root),
                links = tree.links(nodes);
            console.log(nodes);
                
            var link = svg.selectAll(".link")
                    .data(links)
                    .enter().append("path")
                    .attr("class","link")
                    .attr("d", diagonal);
            
            var node = svg.selectAll(".node")
                    .data(nodes)
                    .enter().append("g")
                    .attr("class", "node")
                    .attr("transform", function(d) {return "translate(" + (d.y + margin) + "," + d.x + ")";});
            
            //this section intended to create rectangles for matrix; right now it just shows squares by each node
            node.append ("rect")
                .attr("width", function(d) { return (typeof d.Living_Wage != "undefined" ? 100 : 0); })
                .attr("height", 30)
                .attr("fill", function(d) { return (d.Living_Wage > 20 ? "#FF5050" : "#00CC99"); })
                .attr("stroke", function(d) { return (d.Living_Wage > 20 ? "#CC0000" : "#009999"); })
                .attr("transform", "translate(80, -15)");

            node.append("text")
                    .attr("dx", function(d) {return (d.children ? -8 :8) + 80; })
                    .attr("dy", 3)
                    .style("text-anchor", function(d) {return d.children ? "end": "start"; })
                    .text(function(d) {return d.Living_Wage; });//return d.Living_Wage ? ": $" +d.Living_Wage : "";});
                

                //.attr("y", function(d) {return d.y;});
            //.attr("transform", function(d) {return "translate(" + (d.y) + "," + (d.x -27.5) + ")";});

            node.append("circle")
                    .attr("r", 4.5);
            
            
            
            node.append("text")
                    .attr("dx", function(d) {return d.children ? -8 :8; })
                    .attr("dy", 3)
                    .style("text-anchor", function(d) {return d.children ? "end": "start"; })
                    .text(function(d) {return d.name; });//return d.Living_Wage ? ": $" +d.Living_Wage : "";});

                    
                    
        });
        
        d3.select(self.frameElement).style("height", height + "px");
            
        </script>
    </body>
</html>
